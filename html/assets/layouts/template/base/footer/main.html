<!-- </main> -->

%%FOOT_NAVBAR%%

</body>
<script type="text/javascript">
    const writeLog = function (msg) {
        let date = new Date();
        window.console.log(date.toISOString() + ' ' + msg);
    };

    jQuery(document).ready(function () {
            $('.rating').on(
                'change', function (e) {
                    console.log('Rating selected: ' + e.target.id);
                    console.log('Rating selected: ' + $(this).val());
                    $.ajax({
                        type: "post",
                        url: "process.php",
                        data:
                        {
                            'submit': 'rating',
                            'id': e.target.id,
                            'rating': $(this).val(),
                        },
                        cache: false,
                        success: function () {
                            // window.opener.location.reload(true);
                            // window.close();
                        }
                    });
                });
        });

        $("#ajaxform").submit(function (e) {
            var postData = $(this).serializeArray();
            var formURL = $(this).attr("action");
            var curLoc = location;
            $.ajax(
                {
                    url: 'process.php',
                    type: "POST",
                    data: postData,
                    // data: jQuery.param({'submit': 'playlist', 'data': postData}) ,
                    success: function (data) {


                        window.location = data;


                        //data: return data from server
                    }

                });

        });




    /*
        jQuery(function($) {
            let f = $('#formId');
    
            let xhrOptions = {
                url: f.attr('action'),
                type: f.attr('method'),
                data: {},
                cache: false,
                xhr: function() {
                    let xhr = $.ajaxSettings.xhr();
                    if ('undefined' === typeof xhr.upload.onload || null === xhr.upload.onload) {
                        //override the upload.onload event, only if it has not already been
                        xhr.upload.onload = function() {
                            //onload is triggered immediately after the POST headers are sent to the recipient
                            writeLog('Upload Completed - Ending Request');
                            xhr.abort();
                        };
                    }
                    return xhr;
                },
            };
    
            f.on('submit', function(e) {
                e.preventDefault();
    
                let formData = f.serialize();
    
                let redirect_url = document.getElementById(f[0][0].id).value;
                writeLog(redirect_url);
    
          
                $.ajax($.extend(true, xhrOptions, {
                    data: formData
                })).done(function(responseText) {
                    //this is never triggered since the request is aborted
                    writeLog('Success');
                    writeLog(responseText);
                }).fail(function(jqxhr) {
                    writeLog('Request ' + (jqxhr.readyState !== 4 ? 'Aborted' : 'Failed'));
    
                    location.href = redirect_url;
                });
    
    
    
                return false;
            });
        });
        */
</script>



%%_JAVASCRIPT_HTML%%

</html>